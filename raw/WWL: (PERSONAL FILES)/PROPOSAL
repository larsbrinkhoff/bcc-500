.HE ^USEVENTH DRAFT}#^L/MARCH 5, 1974
.GL}"UN-DER-SCORE TRANS-LATORS TRANS-FERS TO-GETHER
.GL TECH-NICAL SUP-PORT STRUC-TURES SIM-PLI-FIED SAFE-GUARDS
.GL RE-STRIC-TIONS RE-QUIRE-MENTS RE-ORGAN-IZED REF-ERENCES
.GL QUAN-TI-TIES PRO-DUC-TION PRO-DUCED PRO-CES-SING
.GL PRO-CEED PRI-VACY PLAN-NING PAR-TIC-ULAR-LY OR-DINARY
.GL NET-WORK MOST-LY MONI-TOR MODI-FIED MEN-TIONED
.GL MAT-TERS MAIN-TAINED IN-VEST-MENT INTER-ACTION
.GL IN-FOR-MA-TION IN-FERIOR IN-CLUDE IM-PLIES 
.GL FUNC-TIONS FOL-LOW-ING EXIS-TENCE EXE-CU-TION EN-FORCED
.GL EN-COUNTERED EN-CAP-SU-LATED EF-FICIENT-LY DO-MAIN
.GL DOCU-MEN-TA-TION DIREC-TION DIF-FERENCES DE-SIGNED
.GL DES-CRIBED DE-FINE CROS-SING CON-SOLI-DA-TION CON-SIS-TING
.GL COM-PU-TER COM-PART-MEN-TAL-IZA-TION CHECK-ER-BOARD
.GL CAP-ABIL-ITY AR-RANGE-MENTS ARBI-TRARY AP-PEND
.GL AD-VANCED AD-DRESS AD-DITION-AL AC-CESS
.GL}"VISUAL-LY UTIL-I-TIES UN-DER-FLOW SUP-POSED SUPER-VISOR
.GL SU-PER-IOR SIM-U-LA-TION SER-VICES SEPA-RATE SE-LEC-TIVE
.GL SEG-MENT SE-CUR-ITY SE-CUR-ING SEC-TION RUN-NING
.GL ROU-TINES RE-SULT-ING RE-SPEC-TIVE-LY RE-QUI-SITE
.GL RE-QUEST RE-PRE-SEN-TA-TIONS RE-OR-GAN-IZA-TION
.GL RE-MOVED REGIS-TER PUR-POSE PRO-VIDED PRO-TEC-TION
.GL PRO-POSED PRO-GRAM PER-TAIN PAR-TI-CI-PA-TING PARA-GRAPHS
.GL OR-GAN-IZA-TIONS OP-POR-TUN-ITY OPER-ATIONS OPER-ATING
.GL MILI-TARY MICRO-PRO-CES-SOR MAN-NER MAN-AGE-MENT
.GL KNOW-LEDGE IN-VO-CA-TION IN-SE-CURE IN-DE-PEN-DENT
.GL IM-PLI-CA-TIONS HARD-WARE GEN-ERAL-LY FUNC-TION-ING
.GL FEA-TURES FEAS-IBLE EX-TEND EXER-CISE EXE-CUT-ING
.GL EX-CEP-TION EX-AM-PLE EN-VIRON-MENTS EN-TI-TIES
.GL EM-PLOYED ELSE-WHERE DIREC-TORY DE-TER-MI-NA-TION
.GL DES-CRIP-TORS DEPICTS DE-GREE COR-RECT-NESS CO-OPER-ATION
.GL CON-TRI-BU-TIONS CON-SUL-TA-TION CON-STRAINTS COM-PU-TA-TION-AL
.GL COM-PRE-HEN-SIVE COM-PILER COM-PAR-A-TORS COM-MUN-ICA-TION
.GL CHAR-AC-TER-IZING CHAR-AC-TER-IZED CER-TI-FI-CA-TION
.GL CEN-TRAL CAPA-BILI-TIES BE-LIEVABLY AVAIL-ABLE
.GL AUTO-MA-TION AP-PRO-PRIATE AP-PLI-CA-TIONS AP-PLIED
.GL ANA-LYSIS AL-READY AL-LOWED AC-COM-PLISHED AC-CES-SING
.GL AC-CES-SIBLE UN-STACKED
.GL}"TECH-NIQUES SYS-TEM SE-CURED RE-VISIONS RE-COM-MEN-DA-TION
.GL RE-AS-SEM-BLE PRO-CES-SORS POR-TIONS OB-JECTS MOD-IFI-CA-TIONS
.GL IN-COR-PO-RATE IM-PLE-MEN-TA-TION EN-HANCE-MENTS
.GL DE-TECT CON-TRACT COM-PUT-ING COM-PU-TA-TION AP-PLI-CA-BIL-ITY
.DS
1.0}"^UINTRODUCTION^L
.SP 3
}'/THIS DOCUMENT
PROPOSES A ONE-YEAR PROJECT TO CONTINUE AND EXTEND
WORK IN COMPUTER SECURITY^/PRIVACY BEGUN ON /JANUARY 1,
1974 BY /TASK /I/I (/MULTIPROCESSOR /COMPUTING /SYSTEMS /TECHNOLOGY
GROUP) OF ^UTHE ALOHA SYSTEM^L.
/THE PROPOSED PROJECT WOULD DEVOTE ITS MAIN EFFORTS TO THE 
DEVELOPMENT OF A SECURED ^UTENEX^L-BASED MULTIPROCESSOR COMPUTING
SYSTEM FOR AND IN COOPERATION WITH ^UNASA^L^//AMES' /INSTITUTE FOR
/ADVANCED /COMPUTATION (/I/A/C).
/THE PRESENT /TASK (KNOWN AS THE ^CMCST TASK)
IS NOW PLANNING FOR SUCH A SYSTEM AND BY
/AUGUST 31, 1974 WILL HAVE PRODUCED A NUMBER OF DETAILED RECOMMENDATIONS
AS TO HOW THE PRESENT ^UTENEX^L SYSTEM SHOULD BE MODIFIED TO ACCOMMODATE
THE SYSTEM AND SECURITY REQUIREMENTS OF ^CIAC.}"
/THE MODIFICATIONS ARE BEING DESIGNED IN SUCH A WAY AS TO APPLY
TO OTHER ^UTENEX^L-BASED SYSTEMS
WHERE BETTER SECURITY^/PRIVACY IS ALSO NEEDED.
/SOME OF THE WORK WILL BE OF ENOUGH GENERAL APPLICABILITY
TO EXTEND BEYOND THE ^CTENEX SYSTEM AND APPLY TO OTHER AREAS,
PARTICULARLY THE DEVELOPMENT OF VARIOUS SPECIAL-PURPOSE
SYSTEMS SUCH AS SECURED COMMUNICATIONS PROCESSORS, CENTRAL
FILE SYSTEMS, AND OTHER OPERATING SYSTEM MODULES.

}'/THE ^CMCST TASK WAS FORMED EARLY IN 1972 UNDER
/CONTRACT /N/A/S2-6700 (WITH /A/R/P/A-/I/P/T/O FUNDING) TO WORK IN
CONJUNCTION WITH ^UTHE ALOHA SYSTEM^L, AN EXISTING
RESEARCH PROJECT IN THE /DEPARTMENT OF /ELECTRICAL /ENGINEERING
AT THE /UNIVERSITY OF /HAWAII.
/IT WAS THOUGHT AT THAT TIME THAT THE TWO TASKS WOULD EVENTUALLY
MERGE THEIR EFFORTS.}"/SINCE THEN, HOWEVER, THEIR WORK HAS 
PROCEEDED ALONG DIFFERENT LINES, AND IT NOW SEEMS APPROPRIATE
THAT THEY SHOULD BE UNDER SEPARATE 
CONTRACT.
/BOTH PROJECTS WILL CONTINUE TO BE ADMINISTRATED
UNDER THE /ELECTRICAL /ENGINEERING /DEPARTMENT AND WILL SHARE
QUARTERS, OFFICE PERSONNEL, AND OTHER FACILITIES AS BEFORE.
.EJ 
2.0}"^USUMMARY OF PRESENT AND PROPOSED WORK^L
.SP 3
}'/THE ^CMCST TASK
BEGAN EFFORTS IN /MARCH, 1972 TO REASSEMBLE 
AND REFURBISH, AFTER ITS MOVE TO /HAWAII, THE ^CBCC 500 COMPUTING
SYSTEM AND TO FURTHER DEVELOP ASPECTS OF THE SYSTEM, INCLUDING
COMPLETION OF THE ^CSPL COMPILER AND CONNECTION OF THE SYSTEM
TO THE ^CARPA NETWORK.
[/THIS WORK IS DETAILED IN /SECTION 5.]
/WHEN THIS WORK APPROACHED COMPLETION IN LATE 1973, THE /PROJECT 
BEGAN THE PREPARATION OF RECOMMENDATIONS FOR REVISIONS TO
THE ^CTENEX SYSTEM TO PROVIDE IT WITH
ADDITIONAL SECURITY^/PRIVACY FACILITIES AND TO SECURELY
INCORPORATE IT IN THE FINAL VERSION OF THE ^CIAC SYSTEM.
.SP 5
.EJ 15
2.1}"/PRESENT /WORK
.SP 3

}'/THE SPECIFIC RESEARCH TASKS NOW BEING WORKED ON ARE:
.SS
.SP
.RM 10
.UN 5
1.}"/A RECOMMENDED REORGANIZATION OF THE ^CTENEX MONITOR CODE TO
SEPARATE CRITICAL FROM NON-CRITICAL PORTIONS
IN ORDER THAT THE CRITICAL PORTION MAY BE HARDWARE PROTECTED
FROM THE NON-CRITICAL.

.SP
.UN 5
2.}"/A RECOMMENDED MEANS FOR IMPLEMENTING SUCH HARDWARE PROTECTION
(I.E., A "THIRD RING").

.SP
.UN 5
3.}"/RECOMMENDED ADDITIONS TO THE ^CTENEX SYSTEM TO PERMIT MORE
SELECTIVE GRANTING OF ACCESS TO SYSTEM OBJECTS AND TO PROGRAMS
AS WELL AS USERS.

.SP
.UN 5
4.}"/IDENTIFICATION OF THOSE PORTIONS OF ^CTENEX WHICH
CAN BE REMOVED TO OTHER (MANAGEMENT) PROCESSORS.

.SP
.UN 5
5.}"/PROVISION OF GUIDELINES FOR THE PROPER ORGANIZATION OF CODE
IN MANAGEMENT PROCESSORS AND RECOMMENDATION OF HARDWARE FACILITIES
NEEDED TO SUPPORT THIS ORGANIZATION.

.SP
.UN 5
6.}"/RECOMMENDED HARDWARE AND SOFTWARE CHECKING TECHNIQUES WHICH
WILL IMPROVE THE OPPORTUNITY TO DETECT A SYSTEM FAILURE BEFORE
SIGNIFICANT DAMAGE HAS BEEN DONE.

.DS
.EM 10
.SP 5
.EJ 15
2.2}"/PROPOSED /WORK
.SP 3

}'/FOR THE COMING YEAR WE PROPOSE THE FOLLOWING RESEARCH TASKS:

.SP 3
.RM 9
.SS
.UN 4
1.}"/PARTICIPATION IN THE REVISIONS OF ^CTENEX TO SEPARATE CRITICAL
FROM NON-CRITICAL FUNCTIONS [CF. /SECT. 4.3].}"
/CLERICAL REORGANIZATION WILL BE DIRECTED BY ^CMCST PROJECT STAFF
WORKING IN CONJUNCTION WITH ^CIAC ^CTENEX SUPPORT STAFF.
/DOCUMENTATION WILL BE PRODUCED SPECIFICALLY TO ASSIST SUBSEQUENT
EFFORTS TO AUTHENTICATE THE SECURITY OF THE REORGANIZATION.

.SP
.UN 4
2.}"/IMPLEMENTATION OF HARDWARE MODIFICATIONS TO THE /K/I10 PROCESSOR
[/SECT. 4.3].
^CMCST STAFF WILL DESIGN AND SUPERVISE THE MODIFICATIONS; TESTING 
WILL BE DONE IN CONJUNCTION WITH ^CIAC PERSONNEL.

.SP
.UN 4
3.}"/IMPLEMENTATION OF NEW FORMS OF ^CTENEX OBJECT ACCESS AND 
VERIFICATION OF THEIR SECURITY ASPECTS [/SECT. 4.4].
/CODING AND DOCUMENTATION WILL BE DIRECTED BY ^CMCST STAFF IN
CONJUNCTION WITH ^CIAC ^CTENEX SUPPORT STAFF.

.SP
.UN 4
4.}"/REPLACEMENT OF EXCISED ^CTENEX SYSTEM MANAGEMENT CODE BY CODE
DESIGNED TO COMMUNICATE WITH THE CENTRAL OPERATING SYSTEM
[/SECT. 4.3].
/CODING AND DOCUMENTATION WILL BE DONE PRIMARILY BY ^CMCST STAFF.

.SP
.UN 4
5.}"/IMPLEMENTATION OF CODE FOR THE SYSTEM MANAGEMENT PROCESSORS
[/SECT. 4.5].
^CMCST AND ^CIAC STAFF WILL WORK JOINTLY, WITH DETAILED
ASSIGNMENTS TO BE PROVIDED BY ^CIAC.
^CMCST STAFF WILL SUPPLY THE MICROCODE TECHNOLOGY AND SUPPORT;
^CIAC THE DETAILED REQUIREMENTS OF THE CENTRAL OPERATING SYSTEM.
/SPECIFIC DOCUMENTATION WILL BE PRODUCED TO ASSIST EFFORTS TO
AUTHENTICATE THE SECURITY OF EACH PROCESSOR.

.SP
.UN 4
6.}"/DEVELOPMENT AND IMPLEMENTATION OF HARDWARE CONSTRAINTS IN THE
MANAGEMENT PROCESSOR TO BE USED BY ^CIAC [/SECT. 4.5].
/THE CONCEPTION, PLANNING, AND DOCUMENTATION FOR SUCH MODIFICATIONS
ARE TO BE DONE BY ^CMCST STAFF; ACTUAL HARDWARE MODIFICATIONS
ARE TO BE INCORPORATED IN THE PROCESSORS AS THEY ARE PRODUCED
(BY ^CIAC).

.SP
.UN 4
7.}"/A THEORETICAL INVESTIGATION OF THE IMPLICATIONS OF HARDWARE
CONSTRAINTS ON THE ORGANIZATION AND INTERACTION OF SYSTEM MANAGEMENT
CODE; THIS WORK WILL EXAMINE THE PROPERTIES OF CODE WITH EMPHASIS
ON FLOW ANALYSIS AND RESOURCE ALLOCATION.
.EM 9

.EJ

3.0}"^USUGGESTED WORK STATEMENT^L
.SP 4
.RM 6
.UN 6
.SS
/I.}#/DURING THE CONTRACT YEAR THE CONTRACTOR SHALL DEVOTE HIS
FULL EFFORTS TO RESEARCH AND DEVELOPMENT IN SUPPORT OF
SECURITY^/PRIVACY
MEASURES FOR THE ^CILLIAC ^CIV COMPUTER SYSTEM AT THE /N/A/S/A^//AMES
/INSTITUTE FOR /ADVANCED /COMPUTATION.
/THIS WILL INCLUDE, BUT NOT BE LIMITED TO, THE FOLLOWING
SPECIFIC TASKS:
.SP
.RM 5
.UN 5

1.}"/PARTICIPATION WITH ^CIAC STAFF IN REVISION OF THE ^CTENEX SYSTEM
TO SEPARATE CRITICAL FROM NON-CRITICAL FUNCTIONS.
/THIS PARTICIPATION WILL INCLUDE DIRECTION OF THE EFFORT AND THE
PRODUCTION OF DOCUMENTATION TO ASSIST ANY SUBSEQUENT EFFORTS TO
AUTHENTICATE THE SECURITY OF THE REORGANIZED SYSTEM
.SP
.UN 5
2.}"/IMPLEMENTATION OF HARDWARE MODIFICATIONS TO THE ^CDEC /K/I10
PROCESSOR.
/DESIGN AND DOCUMENTATION OF THE MODIFICATIONS AND THE SUPERVISION
OF THEIR INSTALLATION ARE SPECIFICALLY WHAT IS TO BE DONE.
/ACQUISITION OF PARTS AND OTHER LOGISTICAL ARRANGEMENTS ARE TO BE 
DONE BY ^CIAC.

.SP
.UN 5
3.}"/IMPLEMENTATION OF NEW FORMS OF ^CTENEX OBJECT ACCESS; SPECIFICALLY,
ACCESS CONTROL LISTS FOR FILES AND THE ASSOCIATION OF
ACCESS WITH PROGRAMS AS OPPOSED TO JOBS.
/THIS WILL INCLUDE THE DIRECTION OF JOINT EFFORTS WITH ^CIAC STAFF
AND THE PRODUCTION OF APPROPRIATE DOCUMENTATION.

.SP
.UN 5
4.}"/REPLACEMENT OF EXCISED ^CTENEX SYSTEM MANAGEMENT CODE BY CODE
DESIGNED TO COMMUNICATE WITH THE CENTRAL OPERATING SYSTEM.

.SP
.UN 5
5.}"/PARTICIPATION IN THE IMPLEMENTATION OF CODE FOR THE SYSTEM 
MANAGEMENT PROCESSORS.
/THIS WILL INCLUDE SUPPLYING CONSULTATION AND ADVICE ON MATTERS
RELATING TO THE USE OF MICROCODE IN THE PROCESSORS AND ON THE
USE OF MICROCODE COMPILERS AND SIMULATORS RUNNING ON THE
/B/C/C 500 COMPUTER.

.SP
.UN 5
6.}"/DEVELOPMENT AND IMPLEMENTATION OF HARDWARE CONSTRAINTS IN THE
MANAGEMENT PROCESSOR TO BE USED BY ^CIAC.
/THIS WILL INCLUDE THE CONCEPTION, PLANNING, AND DOCUMENTATION FOR
SUCH MODIFICATIONS, THE ACTUAL HARDWARE WORK TO BE DONE BY ^CIAC.

.SP
.UN 5
7.}"/A THEORETICAL INVESTIGATION OF THE IMPLICATIONS OF HARDWARE
CONSTRAINTS ON THE ORGANIZATION AND INTERACTION OF SYSTEM MANAGEMENT
CODE.
/THIS WILL EXAMINE THE PROPERTIES OF CODE WITH EMPHASIS ON FLOW
ANALYSIS AND RESOURCE ALLOCATION.

.SP 4
.UN 6
/I/I.}"/THE /B/C/C 500 SYSTEM SHALL BE AVAILABLE AS A COMPUTATION
FACILITY IN PERFORMING THE TASKS IN /PART /I OF THE STATEMENT 
OF WORK.}"/IT SHALL ALSO BE MAINTAINED SO AS TO BE AVAILABLE
FOR USE BY /I/A/C PERSONNEL FOR DESIGN AUTOMATION SUPPORT
AND FOR A LIMITED NUMBER OF ^CARPA COMMUNITY RESEARCHERS.
.DS
.EM 11
.EJ 
4.0}"^UDETAILED PROPOSAL: METHODS FOR SECURING THE IAC SYSTEM^L
.SP 3
}'/THE PROPOSED PROJECT WILL WORK CLOSELY WITH THE ^CIAC SYSTEM
DEVELOPMENT STAFF TOWARD THE FINAL CONFIGURATION, DESCRIBED BELOW,
OF A SYSTEM INVOLVING MANY COMPONENTS AND ACCESSIBLE}"
TO A LARGE AND VARIED COMMUNITY OF USERS.
/WE PROPOSE TO EXTEND
OUR PRESENT INVOLVEMENT IN THE PLANNING FOR THIS
SYSTEM TO INCLUDE PORTIONS OF THE
ACTUAL IMPLEMENTATION AND TO PURSUE FURTHER INVESTIGATIONS INTO 
PROVISION OF COMPUTER SECURITY WITH EMPHASIS ON SYSTEMS UTILIZING
MULTIPLE PROCESSORS.
/THIS SECTION DISCUSSES THE PROPOSED WORK IN DETAIL.
/BEFORE GOING INTO THE WORK, HOWEVER, IT IS DESIRABLE TO REVIEW
THE CURRENT AND PLANNED ^CIAC SYSTEMS.
.SP 5
.EJ 15
4.1}"/I/A/C /SYSTEM /DESCRIPTION
.SP 3
}'/THE /I/A/C SYSTEM EXISTS TO PROVIDE A NUMBER OF USERS 
ACROSS THE /UNITED /STATES WITH THE SERVICES OF TWO MAJOR RESOURCES:
THE ^UILLIAC IV^L PROCESSOR, CAPABLE OF EXECUTING PROGRAMS AT THE
RATE OF 150 MILLION OPERATIONS PER SECOND, AND THE ^UUNICON^L MASS
STORAGE DEVICE, CAPABLE OF STORING ON-LINE OVER 85 BILLION
CHARACTERS OF INFORMATION.
/BOTH OF THESE DEVICES ARE UNIQUE AND OF GREAT VALUE, AND
TOGETHER CONSTITUTE
A MAJOR, NATIONAL COMPUTING RESOURCE.
/USERS OF THE ^CILLIAC AND ^CUNICON GAIN ACCESS BY MEANS OF 
THE ^CARPA NETWORK.

}'/THE ^CIAC SYSTEM ALSO INCLUDES A GENERAL-PURPOSE
COMPUTING SYSTEM.
/THIS SYSTEM CONSISTS AT PRESENT OF
A /DIGITAL /EQUIPMENT /CORPORATION
/P/D/P-10 (/K/I10 CENTRAL PROCESSOR) RUNNING THE ^CTENEX OPERATING
SYSTEM.
/THE ^CTENEX SYSTEM CONTROLS THE USER JOB SEQUENCES AND EXECUTES
UTILITY PROGRAMS PROVIDED TO USERS
(GENERAL PURPOSE TEXT EDITORS,
LANGUAGE TRANSLATORS, AN ^UILLIAC^L SIMULATOR, AND OTHERS).
/THESE SERVICES MATERIALLY ASSIST THE USER IN PREPARING,
DEBUGGING, AND RUNNING HIS PROGRAM, AND IN ASSEMBLING AND FORMATTING
HIS DATA.
}'/I/A/C PLANS TO MODIFY THE CURRENT SYSTEM CONSIDERABLY FROM
ITS PRESENT CONFIGURATION.
/THESE MODIFICATIONS ARE TO BE MADE PRIMARILY

.RM 9
.SP
.EJ 14
.SS
.UN 4
(A) TO PROVIDE FOR AN EXPANSION OF USER SERVICES,
.SP

.UN 4
(B) TO INCREASE THE EFFICIENCY OF THE ENTIRE SYSTEM AND, IN PARTICULAR,
THE USE OF THE ^UILLIAC^L AND THE ^UUNICON^L,
.SP

.UN 4
(C) TO ESTABLISH AN INDEPENDENT ^UUNICON^L-BASED CENTRAL FILE
SYSTEM WHICH IS RELIABLE AND CONTINUOUSLY AVAILABLE EVEN WHEN THE
REST OF THE SYSTEM IS NOT; AND
.SP

.UN 4
(D) TO PROVIDE WITHIN THE SYSTEM A CAPABILITY FOR
HANDLING A LARGE NUMBER OF FILES OF
INFORMATION WITH AN ASSURED LEVEL OF PROTECTION.*
.EM 9
.SP 2
.DS

}'/THE FINAL SYSTEM PLANNED BY /I/A/C MAY BE VIEWED AS CONSISTING
OF A CENTRAL OPERATING SYSTEM AND AT LEAST
THE FOLLOWING COMPONENTS:

.RM 10
1)}"^CTENEX SYSTEM

2)}"CENTRAL FILE SYSTEM (^CUNICON)

3)}"^CILLIAC ^CIV SUBSYSTEM

4)}"/BURROUGHS /B6700 SYSTEM

.EM 10
/THESE WILL BE DESCRIBED BRIEFLY IN THE FOLLOWING
PARAGRAPHS.

.SP 4

.SS
^---------------------------------

*/AN EXAMPLE OF THE NEED FOR ASSURING SUCH DATA PROTECTION
CAN BE FOUND IN THE FOLLOWING:
/IT IS FORESEEN THAT THE ^CUNICON MAY STORE
CONSIDERABLE QUANTITIES OF SEISMIC DATA RELATED TO UNDERGROUND
NUCLEAR TESTING.
/IN COOPERATION WITH OTHER NATIONS AND PARTIALLY IN SUPPORT OF
NUCLEAR TEST BAN TREATIES, THIS DATA
(TOGETHER WITH ^CILLIAC PROCESSING CAPABILITY) MUST BE AVAILABLE TO A
NUMBER OF NATIONS 
FOR THEIR OWN ANALYSIS.
^I/ALL PARTICIPATING NATIONS MUST BE ASSURED THAT THE DATA, ONCE
AUTHENTICATED
IN FILES, IS READABLE BY ALL BUT WRITEABLE BY NONE.
/THIS EXAMPLE SERVES TO UNDERSCORE THE NEED FOR CENTRAL SYSTEM
PROTECTION, EVEN WHEN THE INFORMATION BEING PROTECTED IS NOT,
IN THE MILITARY SENSE, CLASSIFIED.
.DS

.EJ

}'4.1.1}"/CENTRAL /OPERATING /SYSTEM

}#/THE CENTRAL OPERATING SYSTEM WILL BE DISTRIBUTED OVER A NUMBER
OF MANAGEMENT PROCESSORS CONNECTED TO A LARGE CENTRAL
MEMORY.
/THESE MANAGEMENT PROCESSORS WILL NOT BE /P/D/P-10'S, AND 
THE OPERATING SYSTEM WILL NOT BE THE ^UTENEX^L SYSTEM.
[/THE MANAGEMENT PROCESSOR TO BE USED WAS DEVELOPED BY THE ^CMCST
TASK FOR ^CIAC AND IS DESCRIBED IN /SECTION 5.]
/THE MANAGEMENT PROCESSORS WILL RUN FIXED PROGRAMS -- PART IN
/P/D/P-11 CODE AND PART IN MICROCODE --
TO PERFORM SUCH SYSTEM-WIDE
FUNCTIONS AS SCHEDULING, INPUT-OUTPUT, MONITORING, AND
STORAGE MANAGEMENT.

}#/BOTH THE ^CILLIAC SUBSYSTEM (WHICH CONTAINS A DIFFICULT TO MANAGE
HIGH SPEED DISK FILE) AND THE ^CUNICON WILL HAVE THEIR OWN
MANAGEMENT PROCESSORS.
/ALL OF THE CUSTOMARY ON-LINE PERIPHERAL DEVICES WILL BE
CONTROLLED BY ANOTHER MANAGEMENT PROCESSOR, AS WILL
ALL COMMUNICATION BETWEEN THE SYSTEM AND ITS VARIOUS USERS 
(I.E., THE /A/R/P/A NETWORK).
/THE CENTRAL MEMORY WILL
HAVE ATTACHED TO IT A BUFFER DISK
TO ABSORB THE PEAK SURGES OF MEMORY ACTIVITY WHICH WILL RESULT
WHEN AN ^UILLIAC^L PROCESS IS TERMINATED AND ANOTHER ONE MUST BE
LOADED.
/THIS BUFFER DISK AND THE PRESENT ^CTENEX SWAPPING DRUM 
WILL BE CONTROLLED BY
ONE OR MORE MEMORY MANAGEMENT PROCESSORS, WHICH WILL ALSO GOVERN
THE ALLOCATION OF SPACE WITHIN THE CENTRAL MEMORY.

.SP 2
.EJ 10
}'4.1.2}"^CTENEX /SYSTEM

}'^CTENEX WILL BE EXTENSIVELY MODIFIED, ALTHOUGH THE
MODIFICATIONS WILL NOT BE APPARENT TO THE SYSTEM'S USERS.
/ALL OF THE SYSTEM'S CURRENT MANAGEMENT FUNCTIONS WILL BE REMOVED
INTO THE CENTRAL OPERATING SYSTEM AND INTEGRATED WITH OTHER SYSTEM
MANAGEMENT ACTIVITY.
/THE REMAINING PORTIONS OF THE ^UTENEX^L CODE -- PRIMARILY
THOSE WHICH IMPLEMENT THE ^CTENEX FILE SYSTEM AND PROVIDE 
USER
SERVICES -- WILL BE MODIFIED SO THAT SUCH
CODE MAY COMMUNICATE WITH THE (REMOVED) SYSTEM MANAGEMENT CODE.

}'/ALL OF THE CHANGES TO ^UTENEX^L WILL BE MADE WITH A 
STRICT ADHERENCE TO THE CONSIDERATIONS OF USER PRIVACY.
/THE MANNER IN WHICH THIS WILL BE DONE IS DISCUSSED IN /SECTION 4.3.
/THE NECESSITY FOR MAKING THE CHANGES ALSO
PRESENTS
AN OPPORTUNITY TO INTRODUCE INTO THE SYSTEM SOME ADDITIONAL
SECURITY^/PRIVACY FACILITIES.
/THESE ARE DISCUSSED IN /SECTION 4.4.

.SP 2
.EJ 10
}'4.1.3}"/CENTRAL /FILE /SYSTEM
}'/THE CENTRAL FILE SYSTEM WILL INCLUDE THE ^UUNICON^L AND ONE
OR MORE MANAGEMENT PROCESSORS.}"
/IT SHOULD BE
REGARDED AS AN INDEPENDENT SYSTEM,
AND IT HAS ITS OWN CONNECTION TO THE /A/R/P/A NETWORK.
/THE CENTRAL FILE SYSTEM WILL BE
ACCESSIBLE TO NETWORK USERS
EVEN IF THE REST OF THE /I/A/C SYSTEM IS NOT FUNCTIONING.
/I/A/C SYSTEM USERS MAY ACCESS THE
CENTRAL FILE SYSTEM NO DIFFERENTLY FROM OTHER NETWORK USERS.
/THE CENTRAL FILE SYSTEM WILL HAVE ITS OWN SEPARATE DIRECTORY
STRUCTURE AND SECURITY^/PRIVACY MECHANISMS;
IT WILL BE COMPLETELY INDEPENDENT OF ^CTENEX.

.SP 2
.EJ 10
}'4.1.4}"^CILLIAC ^CIV /SUBSYSTEM

}'/THE ^CILLIAC ^CIV SUBSYSTEM CONSISTS OF THE ^CILLIAC ^CIV
PROCESSING ARRAY, CONTROL UNIT, AND HIGH SPEED DISK (CALLED THE ^CILLIAC
DISK), TOGETHER WITH A
MANAGEMENT PROCESSOR.
/THE MANAGEMENT PROCESSOR IS DEVOTED PRIMARILY TO MANAGEMENT
OF DATA TRANSFERS BETWEEN THE ARRAY AND
THE ^CILLIAC DISK -- A TASK OF CONSIDERABLE MAGNITUDE.
/SECURITY CONSIDERATIONS FOR THE ARRAY STORAGE ARE SIMPLE,
SINCE IT DEALS ONLY WITH ONE JOB AT A TIME; THE USUAL SOLUTION OF
PURGING THE SYSTEM AS THE SWITCH IS MADE FROM ONE JOB TO ANOTHER
IS SUFFICIENT TO KEEP JOBS FROM INTERFERING WITH OR HAVING ACCESS
TO EACH OTHER.
/SECURITY OF INFORMATION ON THE ^CILLIAC DISK WILL BE PROVIDED
BY PROTECTION MECHANISMS IMPLEMENTED WITHIN THE MANAGEMENT PROCESSOR.

.SP 2
.EJ 10
}'4.1.5}"/BURROUGHS /B6700 /SUBSYSTEM
}'/THE INTERIM AND FINAL SYSTEMS BOTH INCLUDE A
/BURROUGHS /B6700 COMPUTING SYSTEM, THE MAIN PURPOSE OF WHICH IS
TO CARRY OUT CERTAIN PREPARATION TASKS FOR ^CILLIAC PROGRAMS
(MAINLY COMPILING).}"/SECURITY CONSIDERATIONS FOR THIS SYSTEM
WILL PROBABLY DICTATE THAT, UPON REQUEST, IT CAN BE OPERATED
IN ONE-USER-AT-A-TIME (NON-MULTIPROGRAMMING) MODE AND THAT IT BE
PURGED AFTER EACH JOB.

.SP 5
.EJ 15
4.2}"/SCOPE OF THE /PROPOSAL
.SP 3

}'/THIS PROPOSAL IS DIRECTED TO THE IMPLEMENTATION OF THE
CENTRAL OPERATING SYSTEM AND THE REORGANIZATION OF THE ^CTENEX
SYSTEM WITH APPROPRIATE SECURITY CONSIDERATIONS.
/THE DIRECT ATTENTION OF THE PROJECT WILL BE GIVEN ONLY TO THESE
ITEMS, BUT
CERTAIN ASPECTS OF
THE WORK WILL IMPINGE ON THE DESIGN AND IMPLEMENTATION 
OF THE CENTRAL FILE SYSTEM AND THE ^CILLIAC ^CIV SUBSYSTEM.

}'/WE FIRST DISCUSS [/SECTION 4.3] THE REORGANIZATION OF ^CTENEX
TO REMOVE ITS MANAGEMENT CODE AND TO PROVIDE FOR VERIFIED SECURITY
OF THE RESULTANT CODE RUNNING ON THE /K/I10 PROCESSOR.
/WE PROPOSE TO PARTICIPATE IN THIS WORK THROUGH DETAILED CONSULTATION
AND EVEN ACTUAL CODING EFFORTS WHERE THIS SEEMS CALLED FOR.

}'/NEXT [/SECTION 4.4] WE DISCUSS CERTAIN NEEDED ENHANCEMENTS
TO ^CTENEX.}"
/AGAIN WE WILL PROVIDE NECESSARY CONSULTATION AND^/OR CODING MANPOWER.

}'/FINALLY, WE DISCUSS [/SECTION 4.5] IMPLEMENTATION OF PROTECTION
MECHANISMS IN THE MANAGEMENT PROCESSOR CODE.
/IN THIS AREA WE PROPOSE TO TAKE A MAJOR ROLE: IN TERMS 
OF DESIGN AND
IMPLEMENTATION OF THE CODE; AND IN THE DETERMINATION OF NEW
CONSTRAINTS WHICH WILL GREATLY SIMPLIFY THE PROBLEMS
OF VERIFYING SUCH CODE.

.SP 5
.EJ 15
4.3}"/PROVIDING /SECURITY IN THE ^CTENEX /SYSTEM
.SP 3
}'/THE REMOVAL OF ALL ^CTENEX SYSTEM MANAGEMENT CODE AND ITS
INTEGRATION INTO THE CENTRAL OPERATING SYSTEM HAS ALREADY BEEN
MENTIONED.
/THIS CODE WILL BE REPLACED WITH A SMALL AMOUNT OF NEW CODE TO
COMMUNICATE WITH THE MANAGEMENT PROCESSORS (THE CENTRAL OPERATING
SYSTEM).

}'/THE REMAINING ^CTENEX CODE (THE BULK OF THE ^CJSYS CODE)
WILL BE EXTENSIVELY REORGANIZED
TO PROVIDE WITHIN THE
RESULTING STRUCTURE A WELL-DEFINED WALL OF PROTECTION WHICH INCLUDES
ONLY A NECESSARY MINIMUM OF THE CURRENT ^CTENEX MONITOR.
/ALL MODIFICATIONS TO ^CTENEX
WILL BE DONE IN SUCH A WAY THAT ^-NO CURRENT USER PROGRAMS
(WITH THE POSSIBLE EXCEPTION OF A HANDFUL OF PRIVILEGED PROGRAMS)
^-WILL BE AFFECTED^E.

}#/THE CURRENT /K/I10 ^CTENEX SYSTEM UTILIZES TWO PROCESSOR MODES:
ONE FOR THE USER CODE AND ONE FOR THE SYSTEM CODE.
/THESE MODES GOVERN THE INSTRUCTION SET AND MEMORY SPACE VISIBLE
TO A USER OR SYSTEM PROCESS.
/SINCE ONLY ONE MODE IS USED FOR ALL OF THE SYSTEM CODE,
EVERY SYSTEM ROUTINE HAS THE SAME CAPABILITY AS EVERY OTHER SYSTEM
ROUTINE (I.E., THE FULL CAPABILITY OF THE HARDWARE) WHETHER IT
NEEDS IT OR NOT; AND THE SYSTEM MUST THUS BE TREATED AS A SINGLE
(LARGE) ENTITY IN ANY ATTEMPTS TO VERIFY ITS GOOD BEHAVIOR.

}'/CLEARLY WHAT IS NEEDED TO ALLEVIATE THIS PROBLEM IS A NUMBER
OF LEVELS OF CAPABILITY ON WHICH VARIOUS SYSTEM ROUTINES CAN RUN.
/EVEN ONE ADDITIONAL PROCESSOR MODE WITH SUITABLE HARDWARE RESTRICTIONS
WOULD BE OF GREAT VALUE, SINCE MOST OF THE ^CJSYS CODE IS CONCERNED
ONLY WITH THE ACTIVE USER AND HAS NO NEED TO ACCESS SYSTEM-WIDE
DATA STRUCTURES.

}'/THE /K/I10 HAS SUCH A MODE; ITS EXECUTIVE MODE HAS TWO SUBMODES
CALLED "KERNEL" AND "SUPERVISOR" MODES.
/SUPERVISOR MODE HAS LARGELY THE SAME INSTRUCTION AND MEMORY
RESTRICTIONS AS USER MODE.
(/IT CAN, HOWEVER, READ PAGES OF THE KERNEL; THIS CAPABILITY WE
PROPOSE TO ELIMINATE.)
/KERNEL MODE HAS NO INSTRUCTION
RESTRICTIONS AND NO MEMORY CONSTRAINTS.

}'/IN THE ^CTENEX REORGANIZATION, KERNEL AND SUPERVISOR MODES
WILL BE MODIFIED SLIGHTLY TO INCREASE THE PROTECTION AND DECREASE
THE CAPABILITIES OF KERNEL MODE.
/THEN THE ^CJSYS CODE WILL BE DIVIDED INTO "CRITICAL" AND "NON-CRITICAL"
PORTIONS.
/THE CRITICAL PORTION WILL REQUIRE ACCESS TO SYSTEM-WIDE DATA
OR WILL NEED TO COMMUNICATE WITH THE CENTRAL OPERATING SYSTEM AND
WILL RUN UNDER KERNEL MODE CAPABILITIES; THE NON-CRITICAL
PORTION WILL DEAL MAINLY WITH THE ACTIVE USER, WILL NOT NEED 
ACCESS TO SYSTEM-WIDE INFORMATION, AND WILL RUN UNDER SUPERVISOR
MODE CONSTRAINTS.
/THE AMOUNT OF SYSTEM CODE RUNNING UNDER KERNEL MODE 
WILL BE ONLY A FRACTION OF THE CURRENT ^CTENEX MONITOR CODE.
/THIS DRASTIC REDUCTION IN SIZE WILL HELP
MAKE FEASIBLE THE VERIFICATION 
OF THE ^CTENEX ^IKERNEL
AND 
WILL RESULT IN THE ESTABLISHMENT OF A CLEARLY-DEFINED WALL OF
PROTECTION BETWEEN EACH USER AND THE REST OF THE SYSTEM AT THE 
ENTRANCE TO THE KERNEL.
}'/IT SHOULD AGAIN BE STRESSED THAT NO USER PROGRAMS
WILL BE AFFECTED
BY THE SYSTEM REORGANIZATION.
/MANY NEW SYSTEM CALLS -- BOTH ORDINARY /J/S/Y/S'S AND KERNEL CALLS --
MAY BE
ADDED, BUT NONE (EXCEPT POSSIBLY PRIVILEGED ONES) WILL BE DELETED 
OR MODIFIED IN SUCH A WAY AS TO REQUIRE CHANGES TO EXISTING
USER CODE.
/FIGURE 1 ILLUSTRATES THE CHANGES WHICH WILL BE MADE.
.EJ
.SP 26
.CE
/FIGURE 1A.}"/CURRENT ^CTENEX /SYSTEM
.SP 24
.CE
/FIGURE 1B.}"^CTENEX AFTER /REORGANIZATION
.EJ


4.4}"/IMPROVING /PROTECTION OF /OBJECTS IN THE ^UTENEX^L /SYSTEM
.SP 3
}'/THE PRECEDING SECTION DISCUSSES WAYS
IN WHICH
THE PRESENT ^UTENEX^L SYSTEM WILL BE MODIFIED TO OPERATE IN 
THE /I/A/C SYSTEM WHILE HAVING INCORPORATED IN IT A MUCH GREATER
DEGREE OF (VERIFIED) PROTECTION.
/THE PRESENT ^UTENEX^L, HOWEVER, LACKS SOME FACILITIES RELATED TO
OBJECT ACCESS CAPABILITIES WHICH ARE 
BADLY NEEDED IN A SYSTEM WITH SUCH A LARGE AND DISPARATE USER
COMMUNITY AS ^CIAC WILL SERVE.
/WE PROPOSE TO INCORPORATE SUCH FACILITIES INTO THE SYSTEM DURING
THE REORGANIZATION EFFORT.
/THE RESULTING NEW CODE WILL ALSO BE DIVIDED INTO CRITICAL AND
NON-CRITICAL PORTIONS GOING RESPECTIVELY INTO THE (VERIFIED) KERNEL
AND THE (NON-VERIFIED) SUPERVISOR CODE.

.SP 2
.EJ 10
}'4.4.1}"/PROVIDING /MORE /SELECTIVE /ACCESS /SPECIFICATION

}'/A COMPUTING SYSTEM SHOULD BOTH PROVIDE ADEQUATE
SECURITY OF EACH OF ITS USERS' FILES AND INCLUDE
FEATURES WHICH FACILITATE FILE SHARING.
/THIS "SECURE SHARING" OF FILES IS IMPLEMENTED IN ^CTENEX
PRESENTLY ALONG THE FOLLOWING LINES:

.RM 9
.SS
.SP
.UN 4
1.}"/SEVERAL KINDS OF RESTRICTED ACCESS TO FILES ARE DEFINED (AMONG
THEM: ^UREAD, WRITE, EXECUTE, ^LAND ^UAPPEND^L ACCESS).

.SP
.UN 4
2.}"/ALL OPERATIONS ON FILES ARE CHARACTERIZED BY THE KINDS
OF ACCESS THEY NEED TO THE FILE THEY OPERATE ON. 
/THE SYSTEM CALLS THAT IMPLEMENT THESE OPERATIONS ALWAYS CHECK TO 
SEE THAT THE CALLING USER HAS (AT LEAST) THE REQUIRED ACCESS TO
THE FILE.

.SP
.UN 4
3.}"/THE SYSTEM PERMITS DIFFERENT CATEGORIES OF ACCESS TO EACH
OBJECT BELONGING TO A USER ACCORDING TO WHETHER THE CALLING USER
IS A MEMBER OF ONE OF THREE CLASSES: THE USER HIMSELF (^IOWNER),
A MEMBER OF A DEFINED ^IGROUP, AND THE ^IPUBLIC (ALL OTHER USERS).

.SP

.DS

.EM 9
}'/THIS SCHEME FOR SELECTIVELY SHARING INFORMATION IS NOT
ADEQUATE FOR THE ^CIAC SYSTEM WITH ITS LARGE USER
COMMUNITY.
/THE ONLY WAY A USER MAY GIVE ANOTHER USER ACCESS TO ONE OF
HIS FILES (OTHER THAN BY GIVING SUCH ACCESS TO ^IALL USERS)
IS TO USE THE GROUP MECHANISM; AND ^CTENEX PERMITS A TOTAL OF
ONLY 36 GROUPS.

}'/WE PROPOSE TO ADD TO ^CTENEX
SOME FORM OF ACCESS CONTROL LIST WHICH WILL BE ASSOCIATED WITH EACH
^UTENEX^L FILE.
/SUCH A LIST WILL TAKE THE FORM EITHER OF AN EXPLICIT LIST OF USER
NAMES AND THEIR ASSOCIATED ACCESS TO THE FILE (AS IN ^UMULTICS^L)
OR A LIST OF ACCESS LOCKS (AS IN THE /B/C/C 500).

.SP 2
.EJ 10
}'4.4.2}"/ASSOCIATING /ACCESS WITH /PROGRAMS

}'/WE HAVE SEEN IN THE PREVIOUS SECTION THAT THE CAPABILITIES
TO ACCESS PROTECTED OBJECTS ARE ASSOCIATED IN ^CTENEX WITH THE
IDENTITY OF USERS OF THE SYSTEM.
/WE PROPOSED A MODIFICATION TO MAKE POSSIBLE A MORE SELECTIVE 
ASSOCIATION OF USERS WITH CAPABILITIES THAN IS NOW AVAILABLE.
/THIS ENHANCEMENT OF ^CTENEX IS NECESSARY FOR IT TO BE REALLY
USEFUL IN /I/A/C'S TYPE OF USER ENVIRONMENT, BUT IT ISN'T 
SUFFICIENT TO SOLVE SOME OF THE PROBLEMS THAT ARE ALREADY
BEING ENCOUNTERED BY ^CIAC.
/THESE PROBLEMS ARE A CONSEQUENCE OF THE WAY ^CTENEX BINDS USERS AND
THEIR CAPABILITIES TO PROGRAMS BEING RUN BY THE USERS.

}'/WHEN A USER HAS PERFORMED ^CTENEX'^ES ^CLOGIN PROCEDURE,
HE IS REPRESENTED IN THE SYSTEM BY A "JOB" CONTAINING A SINGLE
PROCESS, OR "FORK", WITHIN WHICH A SYSTEM-PROVIDED PROGRAM
CALLED THE ^CEXEC IS RUNNING.
/THE USER CAN COMMUNICATE WITH THE ^CEXEC
AND CAN COMMAND IT TO PERFORM A VARIETY OF ACTIONS FOR
HIM.
/IN PARTICULAR HE CAN COMMAND IT TO PERFORM OPERATIONS 
THAT HE HIMSELF IS NOT AUTHORIZED TO PERFORM.
/THE WAY ^CTENEX GUARDS AGAINST THIS IS, OF COURSE, TO RESTRICT
THE CAPABILITIES OF THE ^CEXEC TO EXACTLY THOSE OF THE USER,
AS DETERMINED AT ^CLOGIN TIME.
/THE SAME APPLIES TO ANY OTHER PROGRAMS RUN BY THE USER.
/THESE PROGRAMS WILL RUN IN "INFERIOR FORKS" OF THE ^CEXEC AND WILL
HAVE NO CAPABILITIES BEYOND THOSE POSSESSED BY THE ^CEXEC.

}'/THIS SCHEME IS PERFECTLY ^ISECURE (ASSUMING THE CORRECTNESS
OF THE ^CTENEX MONITOR), SINCE IT ENSURES THAT NO PROGRAM
A USER RUNS CAN DO ANYTHING THE USER ISN'T AUTHORIZED TO DO.
/THE PROBLEM IS THAT THERE ARE CASES WHERE ONE WISHES TO ALLOW
USERS TO RUN SPECIFIC PROGRAMS WHICH EXERCISE CAPABILITIES ^INOT
POSSESSED BY THE USER HIMSELF.
/FOR EXAMPLE, MANY ^CJSYS^EES ARE LIKE THIS.
/THEY CAN BE INVOKED BY THE USER'S PROGRAM TO PROVIDE SERVICES
WHICH REQUIRE THE USE OF CAPABILITIES FAR IN EXCESS OF THOSE THE
USER CAN DIRECTLY EXERCISE.

}'/AS A SYSTEM DEVELOPS TO MEET THE REQUIREMENTS OF ITS USER
COMMUNITY, THE NEED FOR NEW USER SERVICES CONSTANTLY ARISES.
/WHEN THE PERFORMANCE OF SUCH A SERVICE CAN ONLY BE ACCOMPLISHED
USING CAPABILITIES WHICH CANNOT SAFELY BE GIVEN TO ALL USERS}"
OF THE SERVICE, THERE ARE NOW IN ^CTENEX ONLY TWO
POSSIBILITIES FOR IMPLEMENTING THE SERVICE: EITHER IMPLEMENT IT
WITHIN THE MONITOR ITSELF, OR IMPLEMENT IT INSECURELY.

}'/AN EXAMPLE OF THE INSECURE IMPLEMENTATION OF A SERVICE WHICH
IS NEVERTHELESS MUCH USED IS PROVIDED BY THE ^CTENEX ^CSNDMSG PROGRAM.
/THIS PROGRAM IMPLEMENTS A MESSAGE SENDING SERVICE THAT HAS PROVEN
OF GREAT VALUE TO THE MEMBERS OF THE ^CARPA COMMUNITY.
/IT WORKS AS FOLLOWS.}"/EVERY PARTICIPATING USER HAS IN HIS FILE
DIRECTORY A FILE NAMED ^UMESSAGE.TXT^L.}"^CSNDMSG ACCEPTS A MESSAGE
TYPED IN BY A USER, PREFIXES TO IT THE DATE AND TIME AND THE NAME
OF THE SENDING USER, AND APPENDS IT TO THE ADDRESSED USER'S
^UMESSAGE.TXT^L FILE.}"
/THE ^CTENEX FILE PROTECTION MECHANISMS ARE ADEQUATE TO PREVENT
ANY UNAUTHORIZED USER FROM ^IREADING ANOTHER'S ^UMESSAGE.TXT^L
FILE, AND ^CSNDMSG IS (IN THEORY) SECURE IN THIS RESPECT.
/HOWEVER, THE MESSAGE SYSTEM IS ^IINSECURE WITH RESPECT TO FORGERY.
/IN ORDER FOR ^CSNDMSG TO DO ITS WORK, IT MUST BE ABLE TO EXERCISE
^CAPPEND ACCESS ON ANY ADDRESSED USER'S ^UMESSAGE.TXT^L FILE.
/BUT A USER RUNS ^CSNDMSG, LIKE ANY OTHER SUBSYSTEM, AS AN "INFERIOR
FORK" OF HIS JOB'S ^CEXEC.
/AS WE HAVE SEEN, THIS MEANS THAT ^CSNDMSG CAN EXERCISE ONLY THOSE
CAPABILITIES ALSO AVAILABLE TO THE USER ON WHOSE BEHALF IT IS RUNNING.
/AS A RESULT, EVERY USER MUST HAVE ^CAPPEND ACCESS TO EVERY OTHER
USER'S ^UMESSAGE.TXT^L FILE IN ORDER FOR ^CSNDMSG TO WORK; AND THERE
IS NO WAY TO PREVENT A USER FROM USING THIS ACCESS DIRECTLY TO,
FOR EXAMPLE, SEND FALSE "MESSAGES" TO OTHER USERS.

}'/WHAT IS NEEDED IS A MEANS FOR ALLOWING USERS TO RUN
PROGRAMS WHICH USE CAPABILITIES IN EXCESS OF THOSE DIRECTLY 
EXERCISABLE BY THE USER.
/THIS CAN BE PROVIDED IN ^CTENEX WITHOUT TOO GREAT AN UPHEAVAL.
/THREE THINGS ARE REQUIRED:

.SP
.SS
.RM 9
.UN 4
(1) /IT MUST BE POSSIBLE TO ASSIGN CAPABILITIES TO PROGRAMS.
/ONCE THE MODIFICATION OF THE PREVIOUS SECTION IS MADE, AND IT IS
POSSIBLE TO SPECIFY ACCESS TO OBJECTS ON A USER-BY-USER BASIS,
THIS CAN BE ACHIEVED (SOMEWHAT INELEGANTLY) BY CREATING "USERS"
TO REPRESENT THE PROGRAMS AND ASSIGNING THE NEEDED CAPABILITIES
ONLY TO THESE SPECIFIC "USERS".

.SP
.UN 4
(2) /WHEN ONE OF THESE PROGRAMS IS PUT INTO EXECUTION IN A FORK,
THE CAPABILITIES THE PROGRAM POSSESSES AS A "USER" MUST BE
PASSED ON TO THE FORK.
/THIS WILL REQUIRE A NEW ^CJSYS (A VARIANT OF THE CURRENT ^CGET
^CJSYS) FOR USE IN ESTABLISHING SUCH A PROGRAM AS A FORK, AND IT
WILL REQUIRE MODIFICATIONS ELSEWHERE TO ALLOW
THE FORK TO TELL THE SYSTEM WHEN IT WANTS TO USE ITS OWN CAPABILITIES
AND WHEN IT WANTS TO BE RESTRICTED TO THOSE OF THE USER WITHIN 
WHOSE JOB IT IS RUNNING.

.SP
.UN 4
(3) /THE SECURE IMPLEMENTATION OF (2) WILL REQUIRE THE ADDITION
OF CONSTRAINTS ON THE MANIPULATION OF LOWER FORKS BY THEIR SUPERIORS,
WHEN THE LOWER FORK HAS BEEN SET UP TO RUN A PROGRAM WITH INDEPENDENT
"USER" IDENTITY AND CAPABILITIES.
/THE SUPERIOR FORK MUST BE RESTRICTED TO ONLY BEING ALLOWED TO
^ICALL THE LOWER FORK (AND PERHAPS DESTROY IT).
/IT MUST NOT BE PERMITTED TO START IT EXECUTING AT ARBITRARY
POINTS, MODIFY OR LOOK AT ITS MEMORY, ETC.
.DS
.EM 9

}'/WITH THESE (OR EQUIVALENT) MODIFICATIONS TO ^CTENEX,
TOGETHER WITH THOSE OF THE PREVIOUS SECTION, THE ^CSNDMSG PROGRAM
AND OTHERS CAN BE IMPLEMENTED SECURELY.
/THE ^CILLIAC ^CBATCH DRIVER NOW IN USE AT ^CIAC IS ANOTHER EXAMPLE
OF AN IMPORTANT PROGRAM THAT NEEDS THESE FACILITIES.

.SP 5
.EJ 15
4.5}"/SECURITY IN THE /MANAGEMENT /PROCESSORS
.SP 3
}'/THE MODIFICATIONS TO THE /K/I10 PROCESSOR AND THE
REORGANIZATION AND REPACKAGING OF THE ^CTENEX SYSTEM CODE WILL
AID GREATLY OUR ATTEMPT AT PRODUCING A CERTIFIABLE CENTRAL SYSTEM 
FOR ^CIAC.
/THE ^CTENEX KERNEL, HOWEVER, WILL STILL HAVE TO BE VIEWED
AS A SINGLE PROGRAM FOR CERTIFICATION PURPOSES SINCE ALL OF THE
CRITICAL ROUTINES WHICH COMPRISE IT 
WILL RUN UNDER KERNEL MODE WITH THE SAME BASIC POWERS OF ACCESS.
/THUS, FOR THE KERNEL, DEMONSTRATION OF SECURITY
REQUIRES DEMONSTRATION OF CORRECTNESS -- IN GENERAL, A MUCH MORE
ARDUOUS TASK.

}'/IDEALLY, ONE WOULD HOPE TO BE ABLE TO PROVIDE A SEPARATE
EXECUTION ENVIRONMENT FOR EACH OF THE CRITICAL ROUTINES SO THAT
EACH ROUTINE HAS ACCESS ONLY TO THOSE DATA IT NEEDS TO REFERENCE.
/HARDWARE ENFORCEMENT OF THE PROPERLY DEFINED ENVIRONMENTS WOULD 
THEN GUARANTEE THAT 
CROSS-ENVIRONMENT REFERENCES WOULD BE PROHIBITED
AND 
CROSS-ENVIRONMENT TRANSFERS CAREFULLY CONTROLLED.
/THE ^ICORRECTNESS OF SYSTEM ROUTINES WHICH ^ICANNOT ACCESS
SECURITY-ORIENTED DATA STRUCTURES CAN THEN BE CONSIDERED APART
FROM THE OVERALL SYSTEM SECURITY QUESTION AND CERTIFICATION IS
THEREBY GREATLY SIMPLIFIED.

}'/UNFORTUNATELY, THE ^CDEC /K/I10 PROCESSOR CANNOT BE
EASILY MODIFIED TO SUPPORT AN ARBITRARY NUMBER OF EXECUTION ENVIRONMENTS,
SO THE RESULTANT SIMPLIFICATION OF THE SECURITY QUESTION FOR THE ^CTENEX
KERNEL WILL NOT BE READILY ATTAINED.
/A GREAT DEAL OF THE OVERALL OPERATING SYSTEM CODE, HOWEVER, WILL
RESIDE IN THE SEVERAL /P/D/P-11-LIKE MANAGEMENT PROCESSORS WHERE
A MULTI-ENVIRONMENT STRUCTURE ^ICAN BE IMPOSED.
/IN THE FOLLOWING, WE INVESTIGATE THE PROPERTIES OF THE
MULTI-ENVIRONMENT STRUCTURE WHICH WILL BE REQUIRED FOR USE IN THE
MANAGEMENT PROCESSORS AND NOTE THE CRITICAL DIFFERENCES BETWEE
THE PROPOSED SCHEME AND OTHER EXISTING IMPLEMENTATIONS.

.SP 2
.EJ 10
}'4.5.1}"/DESCRIPTOR-ENFORCED /DOMAINS

}'/THE VISIBLE MEMORY SPACE OF A MANAGEMENT PROCESSOR INCLUDES
A LOCAL MEMORY, A NUMBER OF /I^//O DEVICES ON THE ^CUNIBUS, AND
A WINDOW INTO THE SYSTEM'S CENTRAL MEMORY.
/THE MEMORY IS ADDRESSED, HOWEVER, AS A SINGLE, CONTIGUOUS ADDRESS SPACE.
/LOCATED WITHIN THIS SPACE MAY BE FOUND

.SS
.SP
.RM 9
.UN 4
(A) THE CODE FOR EACH OF THE MANAGEMENT ROUTINES,

.SP
.UN 4
(B) THE ASSOCIATED DATA STRUCTURES LOCAL TO THESE ROUTINES, AND

.SP
.UN 4
(C) THE GLOBAL (SYSTEM-WIDE) SHARED DATA STRUCTURES.

.DS
.SP
.EM 9
/THESE VARIOUS ENTITIES ARE DISTRIBUTED ABOUT THE MEMORY SPACE IN THE
FASHION OF A STAINED GLASS WINDOW.
/EACH "PANE" OF THE WINDOW IS CALLED A ^ISEGMENT AND IS CHARACTERIZED
BY A STARTING ADDRESS AND AN ENDING ADDRESS (WHICH TOGETHER
DEFINE ITS EXTENT) AND BY THE TYPE OF ENTITY IT REPRESENTS
(I.E., CODE, LOCAL DATA, OR GLOBAL DATA).

}'/IT IS INTENDED THAT EACH AND EVERY FUNCTION EXECUTED BY
A GIVEN MANAGEMENT PROCESSOR WILL BE ISOLATED AS A DISTINCT CODE
SEGMENT AND WILL HAVE ASSOCIATED WITH IT EXACTLY THE
SET OF LOCAL AND GLOBAL DATA SEGMENTS IT MUST ACCESS IN
ORDER TO PROPERLY PERFORM ITS TASK.
/THIS (HARDWARE ENFORCED) ASSOCIATION OF A SINGLE CODE SEGMENT
WITH ITS NEEDED DATA SEGMENTS WILL BE CALLED ^IENCAPSULATION, AND
THE ENCAPSULATED SEGMENTS WILL COMPRISE A ^IDOMAIN.

}'/IN ORDER TO DEAL APPROPRIATELY WITH DOMAINS WE MUST HAVE A
MEANS FOR

.RM 10
REPRESENTING THEM,

ENFORCING THEIR USE, AND

SWITCHING AMONG THEM.
.EM 10

/THESE TOPICS ARE DEALT WITH IN TURN.

.SP 2
.EJ 10
^-/REPRESENTING /DOMAINS

}'/A DOMAIN REPRESENTATION CONSISTS OF A SET OF SEGMENT
DESCRIPTORS, WHERE EACH SEGMENT DESCRIPTOR CONTAINS THE BASE
AND LIMIT ADDRESS OF EITHER THE SINGLE CODE SEGMENT OR ONE OF THE
LOCAL OR GLOBAL DATA SEGMENTS OF THE GIVEN DOMAIN.
/REPRESENTATIONS OF ^IALL MANAGEMENT DOMAINS FOR A PARTICULAR
PROCESSOR WILL BE COLLECTED
TOGETHER INTO A LOCAL CHECKERBOARD DATA SEGMENT (EACH DOMAIN IS A
SQUARE) WHOSE BASE
ADDRESS IS KNOWN TO THE HARDWARE.
/REPRESENTATIONS WILL BE STATIC (I.E., WILL BE PREDETERMINED AND
NOT ALTERED AS
EXECUTION PROGRESSES).
/THIS IS BECAUSE THE SYSTEM CODE IN A MANAGEMENT PROCESSOR WILL BE
FIXED, UNLIKE USER CODE.

.SP 2
.EJ 10
^-/ENFORCING /THEIR /USE

}'/A FUNCTION MUST BE RESTRICTED TO ACCESSING ONLY THOSE DATA
IT REQUIRES TO PERFORM ITS STATED TASK; THAT IS, IT MUST BE RESTRICTED
TO EXECUTING EXCLUSIVELY WITHIN ITS DOMAIN.
/IN ADDITION IT MAY BE RESTRICTED TO READ-ONLY ACCESS OF A GIVEN
DATA SEGMENT.
/WE REQUIRE THAT THE HARDWARE ENFORCE DYNAMICALLY THESE RESTRICTIONS.

}'/THERE WILL BE A NUMBER OF HARDWARE REGISTERS INTO WHICH
SEGMENT DESCRIPTORS MAY BE LOADED.
/THE STANDARD DOMAIN REPRESENTATION FOR A PARTICULAR DOMAIN CAN
BE FETCHED FROM ITS POSITION IN THE CHECKERBOARD STRUCTURE INTO
THE HIGH SPEED REGISTERS.
/EACH REGISTER PAIR (ONE FOR THE BASE AND ONE FOR THE LIMIT) WILL
BE SELECTIVELY EMPLOYED TO MONITOR THE ADDRESS PLACED ON THE 
MEMORY ADDRESS BUSS OF THE PROCESSOR AND TO INDICATE AN ADDRESSING
EXCEPTION WHEN THE VALUE FALLS OUTSIDE THE GIVEN EXTENT.
"/SELECTIVE EMPLOYMENT" IMPLIES THAT A PARTICULAR REGISTER PAIR WILL
BE CHOSEN FOR THE MONITORING PURPOSE BASED ON THE NATURE OF THE MEMORY
REQUEST
(E.G., READ, WRITE, FETCH FOR EXECUTION).
/SUCH AN ARRANGEMENT HAS IMPLICATIONS FOR THE STRUCTURE OF THE
DOMAIN REPRESENTATION AND THE INHERENT COMPLEXITY OF MANAGEMENT 
FUNCTIONS -- IMPLICATIONS WHICH WILL HAVE TO BE INVESTIGATED.

}'/PERHAPS THE MOST CRUCIAL ASPECT OF THIS PARTICULAR 
IMPLEMENTATION SCHEME LIES IN THE FACT THAT THESE DOMAIN RESTRICTIONS
MAY BE APPLIED EQUALLY WELL TO /P/D/P-11 CODE (WHEN THE PROCESSOR
IS IN EMULATION MODE) AND MICROCODE AT THE BARE MACHINE LEVEL.

.SP 2
.EJ 5
^-/SWITCHING /AMONG /DOMAINS
}'/AS STATED, DOMAINS ARE ASSOCIATED WITH FUNCTIONS.
/EVERY FUNCTION WILL BE ASSIGNED A UNIQUE SEQUENCE NUMBER WHICH
SERVES AS THE INDEX OF ITS ASSOCIATED DOMAIN REPRESENTATION IN
THE CHECKERBOARD SEGMENT.
/AT FUNCTION INVOCATION, THE HARDWARE WILL CALCULATE THE
PROPER OFFSET TO THE APPROPRIATE REPRESENTATION, APPLY A SIMPLE
BASE RELOCATION, AND LOAD THE HARDWARE DESCRIPTOR REGISTERS FROM
THE RESULTING ADDRESS.

}'/SINCE DOMAIN REPRESENTATIONS DO NOT CHANGE OVER NESTED
FUNCTION INVOCATIONS, THEY NEED NOT BE STACKED AND UNSTACKED; ONLY
THE SEQUENCE NUMBER OF THE CALLING FUNCTION NEEDS TO BE SAVED.
/THE RETURN FROM A CALLED FUNCTION WILL USE THE SAVED NUMBER
TO REINSTATE THE STATIC DOMAIN FROM THE CHECKERBOARD SEGMENT IN
PRECISELY THE MANNER DESCRIBED ABOVE.

.SP 2
.EJ 10
}'4.5.2}"/EXTENSIONS TO /DESCRIPTOR-ENFORCED /DOMAINS

}'/THE ABOVE DISCUSSIONS HAVE INTRODUCED THE MEANS BY WHICH 
DOMAINS MAY BE EFFECTIVELY EMPLOYED IN THE MANAGEMENT PROCESSOR
ENVIRONMENT.
/THE DOMAINS CONSIDERED TO THIS POINT, HOWEVER, ARE MINIMAL IN SOME
SENSE SINCE THEY, AS MOST OTHER EXISTING DOMAIN-ORIENTED
IMPLEMENTATIONS,
DEAL STRICTLY WITH LINEAR MEMORY SEGMENTS AND MAKE
NO ATTEMPT TO DEAL WITH THE SIMPLE CONSTRUCTS SO OFTEN EMPLOYED IN
OPERATING SYSTEM IMPLEMENTATIONS.
/TO THIS END WE PROPOSE SOME FURTHER TOPICS OF RELATED RESEARCH.

.SP 2
.EJ 10
^-/DESCRIPTORS FOR /OTHER /MODELING /STRUCTURES

}'/WE PAUSE TO REFLECT ON THE PROPERTIES WHICH ALLOWED US
TO DEVELOP DOMAIN REPRESENTATIONS FOR ^ISEGMENTS: FIRST WE 
CONSTRUCTED A ^IDESCRIPTOR WHICH CONTAINED THE CHARACTERIZING PARAMETERS
OF A LINEAR EXPANSE OF MEMORY (THE BASE AND LIMIT ADDRESSES);
THEN WE INSURED, VIA HARDWARE COMPARATORS, THAT THE ^IACCESSING
^IALGORITHMS ("READ ANYWHERE BETWEEN THE BOUNDS", "WRITE
ANYWHERE BETWEEN THE BOUNDS") PERMITTED FOR REFERENCING MEMORY SEGMENTS
THROUGH ONE OF THESE DESCRIPTORS WERE IN FACT EMPLOYED.

}'/IT IS PROPOSED THAT OTHER ENTITIES BESIDES LINEAR CODE AND
DATA SEGMENTS (FOR EXAMPLE, STACKS, RING BUFFERS, FIELDS, ARRAYS,
STRINGS AND QUEUES) ALSO BE CHARACTERIZED WITHIN A DOMAIN 
REPRESENTATION.
/EACH OF THESE STRUCTURES HAS PARAMETERS WHICH DEPICT IT AND AN 
ACCESSING ALGORITHM WHICH DEFINES ITS USE.
/THE CHARACTERIZING PARAMETERS CAN BE ASSEMBLED INTO A FORMATTED
DESCRIPTOR; ACCESS MADE TO THE STRUCTURE ^ITHROUGH THIS DESCRIPTOR
MUST THEN ADHERE TO THE DICTATES OF THE APPROPRIATE ACCESSING
ALGORITHM.

}'/AS AN EXAMPLE, WE COULD SET ASIDE A CERTAIN REGION OF MEMORY
AND DEFINE IT TO BE A STACK.
/THE DESCRIPTOR FOR THE STACK WOULD SIMPLY CONTAIN THE BASE
AND LIMIT ADDRESSES WHICH DEFINE THE STACK SIZE.
/BY CONVENTION, THE FIRST WORD (BASE ADDRESS) OF THE STACK
WILL CONTAIN THE CURRENT POINTER INTO THE STACK.
/THE ACCESSING ALGORITHM WOULD THEN ENFORCE THE ACTIONS OF PUSHING
ONTO THE STACK (AND CHECKING FOR STACK OVERFLOW) ON ANY STORE OPERATION
AND THE ACTIONS OF POPPING UP FROM THE STACK (AND CHECKING FOR STACK
UNDERFLOW) ON ANY FETCH OPERATION ^-MADE THROUGH THE STACK DESCRIPTOR^E.
/PROVIDED THAT THE ^IONLY DESCRIPTORS WHICH POINTED TO THIS REGION
OF MEMORY WERE ^ISTACK DESCRIPTORS, THE REGION WOULD BE EFFECTIVELY
ISOLATED FROM INADVERTENT MODIFICATION AND WOULD APPEAR AS THOUGH
IT WERE AN ADDRESSABLE HARDWARE ENTITY MUCH LIKE A SIMPLE /I^//O
DEVICE.

}#/SINCE THE DESCRIPTORS FOR ALL DOMAIN REPRESENTATIONS WILL BE 
STATICALLY DEFINED, A PROGRAMMED SEARCH OF ALL DESCRIPTOR EXTENTS
CAN VERIFY THAT A GIVEN REGION ^IIS EMPLOYED ^IONLY AS A STACK;
THIS SEARCH CAN BE CONDUCTED OVER ALL LOCAL MEMORY EXTENTS FOR A
SINGLE PROCESSOR AND ALL GLOBAL EXTENTS FOR THE MULTIPROCESSOR CASE.

.SP 2
.EJ 10
^-/EXTENDING /FUNCTION /DESCRIPTORS
}'/WE HAVE TO THIS POINT DESCRIBED A NUMBER OF ENTITIES FOR 
WHICH DESCRIPTORS MAY BE CONSTRUCTED AND SUGGESTED THE ALGORITHMS
WHICH MIGHT BE USED WHEN REFERENCING THESE ENTITIES THROUGH
THEIR RESPECTIVE DESCRIPTORS.
/WE HAVE ALSO REFERRED TO A "FUNCTION" ENTITY AS A
CODE SEGMENT, THE EXTENT OF WHICH MAY BE DEPICTED IN A BASE^/LIMIT-TYPE
SEGMENT DESCRIPTOR, BUT HAVE MADE NO MENTION YET OF THE ACCESSING
ALGORITHM TO BE EMPLOYED WHEN INVOKING THE FUNCTION THROUGH ITS 
DESCRIPTOR.

}'/SINCE IN GENERAL THE ACTIONS PERFORMED BY A GIVEN BODY
OF CODE WILL BE UNDEFINED IF EXECUTION IS BEGUN AT AN
ARBITRARY POINT, WE REQUIRE THAT INVOCATION OF A FUNCTION OCCUR
AT A LOCATION KNOWN TO THE HARDWARE -- MOST LIKELY THE FIRST
INSTRUCTION IN (I.E., BASE ADDRESS OF) THE SEGMENT.
/THUS IN ORDER TO CALL UPON A GIVEN FUNCTION, THE CURRENTLY
EXECUTING BODY OF CODE MUST EMPLOY THE APPROPRIATE FUNCTION
DESCRIPTOR.}"/THIS IS THE ONLY MEANS BY WHICH TRANSFER OF CONTROL
MAY BE MADE FROM ONE CODE SEGMENT INTO ANOTHER; AND OF COURSE IT
REQUIRES THAT THE CALLED FUNCTION'S DESCRIPTOR APPEAR IN THE STATIC
DOMAIN REPRESENTATION OF THE CALLER.


}'/IN THIS WAY, FUNCTION INVOCATION CAN BE CONTROLLED AND
THE GLOBAL SEQUENCING OF OPERATIONS ENFORCED.
/SINCE DOMAIN BINDING ACCOMPANIES FUNCTION INVOCATION, WE
INSURE THAT CROSSING FROM ONE DOMAIN TO ANOTHER IS DONE PROPERLY
AND IN A PREDEFINED SEQUENCE.
/FLOW GRAPH TECHNIQUES MAY BE APPLIED TO FUNCTION DESCRIPTORS WITHIN
THE STATIC DOMAIN REPRESENTATIONS TO ANALYZE PROGRAM FLOW FOR 
CERTIFICATION PURPOSES; SUCH ANALYSIS WILL HOPEFULLY REVEAL
SEVERAL NEW AREAS FOR FURTHER RESEARCH.

}'/TRANSFER (BY BRANCHING) ^IWITHIN THE LIMITS OF A GIVEN FUNCTION
MAY BE CONSTRAINED BY THE USE OF BRANCH DESCRIPTORS THROUGH WHICH ALL
TRANSFERS MUST REFRACT.
/THE CHARACTERIZING PARAMETERS OF A BRANCH DESCRIPTOR WILL INCLUDE
THE TARGET ADDRESS AS FOR NORMAL INDIRECTION, BUT ALSO THE ^ISOURCE
^IADDRESS OF THE INSTRUCTION PERMITTED TO REQUEST THE TRANSFER.
/THE ABILITY TO EMPLOY A GIVEN BRANCH DESCRIPTOR OF COURSE DEPENDS
ON IT BEING PRESENT IN THE STATIC DOMAIN REPRESENTATION.

}'/FURTHER CONSTRAINTS ON INSTRUCTION SEQUENCING (FOR EXAMPLE
THROUGH THE EMPLOYMENT OF LOOP DESCRIPTORS, TRANSFER VECTOR 
DESCRIPTORS, ETC.) ARE STILL TO BE INVESTIGATED.

.SP 2
.EJ 10
^-/DYNAMIC /MODIFICATION OF /DESCRIPTORS

}'/OUR DISCUSSIONS TO THIS POINT HAVE DEALT SOLELY WITH THE 
NOTION OF STATIC DESCRIPTORS -- THOSE WHICH CAN BE CONSTRUCTED DURING
COMPILE TIME AND INSPECTED (EITHER VISUALLY OR BY PROGRAM) TO INSURE
CONSISTENCY AND ADHERENCE TO THE NEED-TO-KNOW PRINCIPLE.
(/A FUNCTION'S DOMAIN REPRESENTATION CONTAINS DESCRIPTORS FOR ONLY
THE DATA STRUCTURES IT "NEEDS-TO-KNOW" ABOUT.)
/IN THE MANAGEMENT PROCESSOR ENVIRONMENT, HOWEVER, WHERE GLOBAL
OPERATING SYSTEM DATA STRUCTURES OFTEN CONTAIN ^IENTRIES FOR EACH
OF THE KNOWN JOBS OR USER PROCESSES, MORE FLEXIBILITY MAY BE
REQUIRED.

}'/WHAT IS PREFERRED IS THAT THE FUNCTION BE GIVEN A DESCRIPTOR
FOR ONLY THE PARTICULAR TABLE ENTRY IT IS "SUPPOSED" TO REFERENCE
AT A GIVEN INVOCATION.
/FOR THIS PURPOSE IT IS PROPOSED TO ASSOCIATE WITH A FUNCTION THE
DESCRIPTOR FOR A ^ISINGLE (THE ZERO-TH) ENTRY OF A GIVEN DATA 
STRUCTURE ONLY, AND TO AUGMENT THE STATIC DESCRIPTOR BY THE
APPROPRIATE DISPLACEMENT AS IT IS LOADED FROM ITS DOMAIN
REPRESENTATION INTO ITS HARDWARE REGISTERS SO THAT IT DEPICTS THE
SELECTED ENTRY.

}'/THE "APPROPRIATE DISPLACEMENT" CAN BE CALCULATED AS THE
PRODUCT OF THE INDEX OF THE GIVEN ENTRY WITHIN THE TABLE (THIS
INDEX WILL BE HELD IN A SPECIAL "INDEXING REGISTER") AND THE LENGTH
OF A REPRESENTATIVE ENTRY (A QUANTITY WHICH CAN BE STORED WITH THE
ENTRY'S DESCRIPTOR IN THE DOMAIN REPRESENTATION).
/THE OCCURRENCE OF DESCRIPTOR AUGMENTATION (USING A SINGLE VALUE IN
THE INDEXING REGISTER) AT EVERY FUNCTION INVOCATION
WILL SERVE TO EFFECT A COMPARTMENTALIZATION OF THE PROCESSOR WHICH
WILL BE MOST HELPFUL IN THE CERTIFICATION PROCESS.

.SP 2
.EJ 10
}'4.5.3}"/A /LANGUAGE FOR /DOMAIN /GENERATION

}'/SUITABLE SOFTWARE SUPPORT WILL HAVE TO BE MADE AVAILABLE
FOR AT LEAST THE FOLLOWING TASKS ASSOCIATED WITH SECURING
THE MANAGEMENT PROCESSORS; PRELIMINARY STUDIES CAN PROCEED WITHOUT
THESE TOOLS HOWEVER.

.SS
.SP
.RM 9
.UN 5
(1)}"/A LANGUAGE WILL HAVE TO BE DEVELOPED, AND A COMPILER CONSTRUCTED,
WHICH ALLOWS THE IMPLICIT OR EXPLICIT SPECIFICATION OF THE DOMAINS
REQUIRED BY A GIVEN FUNCTION; THE COMPILER WILL BE RESPONSIBLE FOR
CREATING THE VARIOUS DESCRIPTORS TO BE LOADED INTO DOMAIN
REPRESENTATIONS.

.SP
.UN 5
(2)}"A LOADER WILL BE REQUIRED TO SECURELY COPY THE BINARY IMAGE PRODUCED
BY THE COMPILER INTO THE PROPER LOCATIONS IN (CENTRAL AND LOCAL) CORE.

.SP
.UN 5
(3)}"/SEVERAL ANCILLARY PACKAGES WILL BE REQUIRED FOR INVESTIGATIVE
ANALYSIS OF THE SECURITY IMPLICATIONS WHICH CAN BE DERIVED FROM THE
STATIC DOMAIN REPRESENTATIONS; THESE WILL INCLUDE THE FLOW ANALYSIS
ROUTINES MENTIONED PREVIOUSLY.

.SP 2
.DS
.EM 9

.SP 5
.EJ 15
4.6}"/SUMMARY AND /EXPLICIT /GOALS
}'/THE PRECEDING DISCUSSION DESCRIBES A NUMBER
OF METHODS BY WHICH THE /PROJECT CAN ASSIST THE /I/A/C
DEVELOPMENT
STAFF IN SECURING THE ^CIAC SYSTEM AND MAKE SOME GENERAL CONTRIBUTIONS
TO THE SOLUTION OF THE COMPUTING SECURITY^/PRIVACY PROBLEM.
/IT IS BELIEVED THAT SUCH EFFORTS ARE
JUSTIFIED BY
THE FOLLOWING CONSIDERATIONS:
.SP
.SS
.RM 9
.UN 4
1.}"/ALTHOUGH SIGNIFICANT PLANNING FOR IMPROVED PROTECTION AND OTHER MODIFICATIONS
TO ^CTENEX WILL HAVE BEEN DONE BY THE TIME THE CURRENT CONTRACT,
^CNAS-6700, EXPIRES AND SOME IMPLEMENTATION WILL HAVE BEGUN, THE
BULK OF THE IMPLEMENTATION WILL YET REMAIN BEFORE THE ^CIAC SYSTEM
WILL HAVE SOME CLAIM TO SECURITY.
.SP

.UN 4
2.}"/PERSONNEL OF THE ^CMCST /PROJECT HAVE BETTER KNOWLEDGE THAN ANYONE OF THE 
PROPOSED SOLUTIONS TO THE REORGANIZATION OF ^CTENEX AND CAN 
PARTICIPATE IN THE IMPLEMENTATION WITH A HIGH DEGREE OF EFFICIENCY.

.SP
.UN 4
3.}"/THE /PROJECT POSSESSES UNIQUE CAPABILITIES IN THE AREAS OF HARDWARE
DESIGN, MULTIPROCESSOR OPERATING SYSTEM DESIGN (IN PARTICULAR,
THE DIVISION
OF SYSTEM TASKS AMONG MANAGEMENT PROCESSORS), AND THE PROPER
ORGANIZATION OF CODE IN SUCH PROCESSORS.

.SP
.UN 4
4.}"/THE /PROJECT POSSESSES UNIQUE TOOLS FOR SUCH WORK, ESPECIALLY
FACILITIES FOR THE COMPILATION AND SIMULATION OF MICROCODE,
DESIGN AUTOMATION AIDS FOR THE PRODUCTION OF VARIOUS KINDS OF
HARDWARE YET TO BE DESIGNED BY ^CIAC FOR ITS SYSTEM, AND 
CROSS-REFERENCING SOFTWARE FOR DEALING WITH THE ^CTENEX CODE.
.DS
.EM 9
.EJ

}'/THE PROJECT'S EFFORTS FOR THE YEAR WILL THEREFORE BE DIRECTED TOWARD
THE FOLLOWING GOALS:
.SP
.SS
.RM 10

.UN 5
1.}"/DIRECT PARTICIPATION IN THE EFFORTS
TO MODIFY THE ^CIAC SYSTEM.
/IT IS ENVISIONED THAT THIS WORK WILL CONSIST OF ACTUAL CODING
TO BE DONE IN COOPERATION WITH /I/A/C PERSONNEL.
/THIS EFFORT MIGHT EXTEND TO IN-DEPTH
CONSULTATIONS WITH OTHER ORGANIZATIONS IF ^CARPA SHOULD DETERMINE
THAT SOME OF THE RECOMMENDED CHANGES SHOULD BE ADDED TO
OTHER VERSIONS OF ^CTENEX (THUS BENEFITTING MORE USERS).

.SP
.UN 5
2.}"/DIRECT PARTICIPATION IN THE DESIGN OF THE MANAGEMENT PROCESSOR
MICROCODE.

.SP
.UN 5
3.}"/FURTHER EXPLORATION OF A
CHOICE OF HARDWARE ENHANCEMENTS TO THE MANAGEMENT PROCESSOR
STRUCTURE NOW PLANNED FOR USE IN THE /I/A/C SYSTEM AND 
IMPLEMENTATION OF THESE MODIFICATIONS.

.SP
.UN 5
4.}"/EXPLORATION OF THE POTENTIAL VALUE OF HARDWARE
CONSTRAINTS OF THE KIND BEING CONSIDERED.

.SP 3
.DS
.EM 10
}'/THESE GOALS ARE NOT TOTALLY DIRECTED TO SPECIFIC
IMPLEMENTATION PROBLEMS OR A SPECIFIC SYSTEM DESIGN.
/MANY OF THE PROBLEMS WHICH MUST BE SOLVED FOR THE /I/A/C FACILITY
ARE PROBLEMS SHARED BY OTHER GENERAL PURPOSE COMPUTER UTILITIES.
/IT IS FELT THAT MANY OF THE MODIFICATIONS TO ^CTENEX NECESSARY
FOR THE /I/A/C SYSTEM WILL BE TRANSPORTABLE TO OTHER ^CTENEX
FACILITIES.
/THE CURRENT PLANNING FOR THESE MODIFICATIONS IS BEING DONE IN
SUCH A WAY THAT SEPARATE MANAGEMENT PROCESSORS ARE NOT ACTUALLY
REQUIRED; THEIR ACTIVITIES CAN BE HANDLED BY A /K/I10
PROCESSOR, OR A NUMBER OF ^CPDP-11'S CAN BE USED
IN PLACE OF OUR MICROPROCESSOR.
/ALSO, OUR MICROPROCESSOR CAN,
IF MADE AVAILABLE BY SOME SUPPLIER, BE USED BY OTHERS TO
BETTER IMPLEMENT SOME OF THE CURRENTLY KNOWN TECHNIQUES FOR
PRODUCING SECURE SYSTEM KERNELS BUT WHICH REMAIN DIFFICULT ON
PRESENT HARDWARE.

}'/IT IS ANTICIPATED THAT DURING THE PROPOSED WORK A 
COMPUTATIONAL FACILITY WILL BE REQUIRED.
/THE /B/C/C 500 WILL BE USED FOR THIS.
/THE SYSTEM 
IS CURRENTLY BEING USED BY /I/A/C PERSONNEL VIA THE
^CARPA NETWORK FOR DESIGN AUTOMATION IN SUPPORT OF VARIOUS
KINDS OF HARDWARE BEING DESIGNED FOR THE /I/A/C SYSTEM.
/NO MODIFICATIONS OF THE 500 OPERATING SYSTEM ARE CONTEMPLATED;
THE SYSTEM WILL BE OPERATED AS A COMPUTATIONAL FACILITY FOR
THE NEEDS OF THE PROPOSED PROJECT, FOR THE HARDWARE
DESIGN EFFORTS OF THE /I/A/C, AND FOR A FEW OTHER SELECTED
USERS FROM THE ^CARPA COMMUNITY.
/IT WILL ALSO BE USED BY A NUMBER OF STUDENTS IN CONJUNCTION
WITH THEIR COURSES IN COMPUTER PROGRAMMING AND FOR SOFTWARE
DESIGN PROJECTS.

.EJ
5.0}"^UPAST ACCOMPLISHMENTS^L
.SP 3
}'/DURING THE TWO YEARS OF ITS OPERATION (/MARCH, 1972 THROUGH
/FEBRUARY, 1974) THE ^CMCST TASK ACCOMPLISHED A NUMBER
OF ACHIEVEMENTS INCLUDING

.RM 9
.SS
.SP
.UN 4

1) /COMPLETE REFURBISHMENT OF THE /B/C/C 500 COMPUTING HARDWARE
(INCLUDING 6 PROCESSORS, 2 DRUMS, A DISK, A CENTRAL MEMORY,
11 CORE MODULES, CABINETS, POWER SUPPLIES, INTERCONNECTING CABLES,
ETC.);

.SP
.UN 4
2) /CATALOGING, DOCUMENTATION, AND REWORK OF THE /B/C/C 500
OPERATING SYSTEM -- THE MICROCODE AND THE SOFTWARE PORTIONS;

.SP
.UN 4
3) /PRODUCTION OF A WORKING /S/P/L, A 
LARGE AND COMPREHENSIVE
COMPILING SYSTEM (ABOUT 20,000 LINES OF ^CSPL CODE);

.SP
.UN 4
4) /PRODUCTION OF A NUMBER OF HARDWARE DESIGN AUTOMATION AIDS
WHICH CAN BE USED BY OTHERS ON THE /A/R/P/A NETWORK;

.SP
.UN 4
5) /DESIGN OF A MICROCODED PROCESSOR FOR USE WITH THE /I/A/C
SYSTEM; AND

.SP
.UN 4
6) /A STUDY (IN PROGRESS) OF THE ^UTENEX^L OPERATING SYSTEM WITH
RECOMMENDATIONS FOR REORGANIZING IT
FOR PRIVACY^/SECURITY PURPOSES, AND
FOR INTEGRATION INTO THE /I/A/C OPERATING SYSTEM.
.EM 9
.DS

/THESE ACTIVITIES ARE REPORTED IN DETAIL IN OUR /ANNUAL /TECHNICAL
/REPORT FOR 1973 [REF.].

}'/THE MICROPROCESSOR MENTIONED
IN 5) ABOVE IS PARTICULARLY PERTINENT TO THIS PROPOSAL AND IS THUS
DESCRIBED HERE.
/THE PROCESSOR
IS A REPACKAGED DESIGN OF THE ORIGINAL /B/C/C MICROPROCESSOR,
CONFIGURED TO EMULATE EFFICIENTLY A /P/D/P-11 (HAVING A 16-BIT
ARITHMETIC UNIT) AND
EQUIPPED WITH A
^UUNIBUS^L INTERFACE.}"/THE PROCESSOR WAS DESIGNED AT THE REQUEST
OF /I/A/C, FIRST ON A FEASIBILITY BASIS AND LATER ON A PRODUCTION
BASIS WHEN /I/A/C DETERMINED THAT THE /P/D/P-11'S PLANNED
FOR USE AS MANAGEMENT PROCESSORS IN THE /I/A/C SYSTEM DID NOT HAVE
THE REQUISITE COMPUTING POWER FOR SUCH APPLICATIONS.}"/I/A/C'S PLAN
FOR THESE PROCESSORS IS TO PLACE MANY OF THE SYSTEM MANAGEMENT
PROCESSING FUNCTIONS DIRECTLY INTO MICROCODE AS IS DONE IN THE /B/C/C 
500, THEREBY
PROVIDING MUCH GREATER COMPUTING CAPABILITY AND
MAKING OVERALL SYSTEM PROTECTION EASIER TO ACHIEVE.
/A PORTION OF THE MICROCODE EMULATES THE INSTRUCTION SET OF THE
/P/D/P-11^/40, BY WHICH MEANS THE PROCESSOR CAN RUN GENERAL PURPOSE
CODE.
/A SPECIAL EMULATED INSTRUCTION ALLOWS CALLS TO MICROCODED SUBROUTINES.
/THE PROCESSOR THUS HAS THE ABILITY TO RUN FIXED CODE AT VERY HIGH
SPEED (ABOUT FIFTEEN MILLION OPERATIONS^/SECOND), ORDINARY /P/D/P-11
CODE, OR A COMBINATION OF THE TWO.
/DURING THE PROCESSOR'S DESIGN, GREAT ATTENTION WAS PAID TO INCLUDING
CERTAIN FEATURES WHICH CONTRIBUTE GREATLY TO MAINTENANCE AND REPAIR
OF THE PROCESSORS.
/THIS IS A FEATURE OF IMPORTANCE TO ^CIAC BECAUSE OF THE COMPLEXITY
OF THEIR SYSTEM.

.EJ
6.0}"^UREFERENCES^L
.EJ
7.0}"^URELEVANCE TO DOD AND UH NEEDS^L
.SP 3
}'/THE ^CDOD AND ITS VARIOUS AGENCIES HAVE AN IMMENSE INVESTMENT
IN LARGE COMPUTING SYSTEMS WITH ON-LINE STORAGE CAPACITY.
/THE UTILITY OF MOST OF THESE SYSTEMS IS CURRENTLY LIMITED BY SECURITY
CONSIDERATIONS.
/ACCESS CHECKING IS MOSTLY MANUAL; ON-LINE ACCESS IS RESTRICTED.
/IMPROVED COMPUTER SECURITY WILL GREATLY AID ^CDOD BY PROVIDING
THE KIND OF COMPUTING NOW ENJOYED BY OTHERS IN ENVIRONMENTS WHERE
SECURITY IS NOT OF CONCERN.

}'/UNDER A DIRECTIVE OF THE /SECRETARY OF /DEFENSE, THE MILITARY
FORCES ON THE /ISLAND OF /OAJU ARE PLANNING A CONSOLIDATION OF
THEIR TELECOMMUNICATIONS (CALLED ^CCOTCO).
/THE NATURE OF THE ^CCOTCO DONFIGURATION WILL DEPEND ON THE
EXISTENCE OF SECURED PROCESSORS -- BOTH COMMUNICATIONS PROCESSORS
AND GENERAL PURPOSE PROCESSORS.
^CTENEX HAS BEEN MENTIONED AS A CANDIDATE FOR THIS CONFIGURATION,
BUT THE PRESENT SYSTEM LACKS IN SECURITY.
/A REVISED VERSION HAVING IMPROVED OBJECT ACCESS PROTECTION AND MORE
MODULARIZED SYSTEM SOFTWARE WOULD BE OF GREAT USE TO ^CCOTCO.

}'/IN A REPORT PREPARED RECENTLY FOR THE /UNIVERSITY OF
/HAWAII VICE-PRESIDENT FOR BUSINESS AFFAIRS BY THE DIRECTOR OF
THE /U/H /COMPUTING /CENTER, IT WAS STATED THAT ONE OF THE MOST
ANNOYING AND PERSISTENT PROBLEMS FACED DURING 1973 WAS THE LACK
OF ADEQUATE SECURITY FEATURES WITHIN THE /MANOA CAMPUS CENTRAL
FACILITY.
/STUDENT RECORDS -- KEPT ON-LINE -- HAVE BEEN EXAMINED;
USERS' FILES HAVE BEEN MALICIOUSLY MODIFIED; AND EXTRA OFF-HOUR
COMPUTING TIME (WITH NO TERMINAL ACCESS PERMITTED) HAS HAD TO BE
SCHEDULED SO THAT THE SYSTEM COULD BE LOADED WITH FILES CONTAINING
MEDICAL HISTORIES.
/THE WORK OF THE PROJECT WILL NOT IMMEDIATELY PROVIDE RELIEF TO THE
CAMPUS; IN TIME, HOWEVER, SUCH RESULTS WILL FIND THEIR WAY INTO
COMMERCIAL SYSTEMS.

.PAGING MODE OFF
.EJ
.SP 10
.CE
^CABSTRACT
.SP 5
.SS
}'/THIS DOCUMENT PROPOSES TO CONTINUE FOR ONE YEAR THE WORK
OF THE /MULTIPROCESSOR /COMPUTING /SYSTEMS /TECHNOLOGY
GROUP (/TASK /I/I) OF ^UTHE ALOHA SYSTEM^L IN
SECURE COMPUTING SYSTEMS.}"/EFFORTS WILL BE MADE
IN TWO MAIN AREAS:
.SP 3
.RM 9
.UN 4
1)}"/CONTINUING OUR ASSISTANCE TO THE /INSTITUTE OF /ADVANCED
/COMPUTATION IN SECURING ITS LARGE SYSTEM CONTAINING THE ^CILLIAC
^CIV AND ^CUNICON, THIS TIME BY PARTICIPATING IN THE ACTUAL
REORGANIZATION OF ^CTENEX AND IN THE IMPLEMENTATION OF MANAGEMENT 
PROCESSOR CODE; AND
.SP 3
.UN 4
2)}"/DETERMINING A SET OF HARDWARE CONSTRAINTS TO BE ADDED TO THE
MANAGEMENT PROCESSORS AND STUDYING THE EFFECTS OF THESE CONSTRAINTS
ON THE TASK OF SYSTEM VERIFICATION.
.EM 9
.DS

.EJ
.SP 10
.CE
^CFOREWORD
.SP 5
.SS
}'/COMPUTING SYSTEMS HAVE ENABLED MAN TO AMASS}"
LARGE QUANTITIES OF INFORMATION AND ACCESS IT READILY.
/MODERN SYSTEMS KEEP MUCH OF THIS INFORMATION ON-LINE 
(LIKE A BANK KEEPING ITS MONEY IN THE WINDOW).
/THE ESTABLISHMENT OF ADEQUATE SAFEGUARDS ON THE INFORMATION 
IN A COMPUTING SYSTEM IS KNOWN AS ^ICOMPUTER ^ISECURITY OR
^ICOMPUTER ^IPRIVACY.

}'/IN THIS PROPOSAL WE USE THE TERMS "SECURITY",
"PRIVACY", AND "PROTECTION".
/EACH TERM CONNOTES NOT QUITE THE RIGHT MEANING IN CERTAIN CONTEXTS;
HENCE WE USE AT VARIOUS PLACES THAT TERM WHICH IS CLOSEST IN MEANING
AT THE TIME.

}'/IN ANY CASE WE ARE TALKING ABOUT THE PROTECTION
OF POTENTIALLY VALUABLE INFORMATION FROM UNAUTHORIZED ACCESS.
/SECURITY IS USED IN THE SENSE OF ASSURING AN OWNER THAT HIS
INFORMATION IS SAFE.
/PRIVACY IS USED TO EMPHASIZE THAT THE INFORMATION MAY PERTAIN TO
(INNOCENT) PARTIES OTHER THAN THE OWNER AND WHO ARE POWERLESS TO
TAKE THEIR OWN PROTECTION MEASURES.
/PROTECTION IS THE TERM GENERALLY GIVEN TO THE MECHANISMS EMPLOYED
IN THE SYSTEM TO PROVIDE SUCH SAFEGUARDS.

}'/FULL COMPUTER SECURITY INCLUDES THE SECURITY OF THE
COMPUTING EQUIPMENT ITSELF, ACCOUNTING FOR ALL MAGNETIC TAPES AND
OTHER MEDIA ON WHICH INFORMATION CAN BE INTRODUCED INTO OR EXTRACTED
FROM THE SYSTEM, AND THE SCREENING OF PERSONNEL WHO OVERSEE OPERATION
OF THE EQUIPMENT.
/FOR THIS RESEARCH, HOWEVER, WE MAKE THE ASSUMPTION THAT ALL SUCH
MATTERS NOT SPECIFICALLY A PART OF THE OPERATING SYSTEM ARE HANDLED
SEPARATELY.

.EJ
.SP 4
.CE
^UTABLE OF CONTENTS^L

.SP 2
1.0}"^UINTRODUCTION
.SP 2
2.0}"SUMMARY OF PRESENT AND PROPOSED WORK
.SP
.IN 2
2.1}"^L/PRESENT /WORK
.IN 2
2.2}"/PROPOSED WORK
.SP 2
3.0}"^USUGGESTED WORK STATEMENT
.SP 2
4.0}"DETAILED PROPOSAL: METHODS FOR SECURING THE IAC SYSTEM
.SP
.IN 2
4.1}"IAC S^LYSTEM /DESCRIPTION
.SP
.IN 4
4.1.1}"/CENTRAL /OPERATING /SYSTEM
.IN 4
4.1.2}"^CTENEX /SYSTEM
.IN 4
4.1.3}"/CENTRAL /FILE /SYSTEM
.IN 4
4.1.4}"^CILLIAC ^CIV /SUBSYSTEM
.IN 4
4.1.5}"/BURROUGHS /B6700 /SYSTEM
.SP
.IN 2
4.2}"/SCOPE OF THE /PROPOSAL
.IN 2
4.3}"/PROVIDING /SECURITY IN THE ^CTENEX /SYSTEM
.IN 2
4.4}"/IMPROVING /PROTECTION OF /OBJECTS IN THE ^CTENEX /SYSTEM
.SP
.IN 4
4.4.1}"/PROVIDING /MORE /SELECTIVE /ACCESS /SPECIFICATION
.IN 4
4.4.2}"/ASSOCIATING /ACCESS WITH /PROGRAMS
.SP
.IN 2
4.5}"/SECURITY IN THE /MANAGEMENT /PROCESSORS
.SP
.IN 4
4.5.1}"/DESCRIPTOR-ENFORCED /DOMAINS
.IN 11
/REPRESENTING /DOMAINS
.IN 11
/ENFORCING /THEIR /USE
.IN 11
/SWITCHING /AMONG /DOMAINS
.SP
.IN 4
4.5.2}"/EXTENSIONS TO /DESCRIPTOR-ENFORCED /DOMAINS
.IN 11
/DESCRIPTORS FOR /OTHER /MODELLING /STRUCTURES
.IN 11
/EXTENDING /FUNCTION /DESCRIPTORS
.IN 11
/DYNAMIC /MODIFICATION OF /DESCRIPTORS
.SP
.IN 4
4.5.3}"/A /LANGUAGE FOR /DOMAIN /GENERATION
.SP
.IN 2
4.6}"/SUMMARY AND /EXPLICIT /GOALS
.SP 2
5.0}"^UPAST ACCOMPLISHMENTS
.SP 2
6.0}"REFERENCES
.SP 2
7.0}"RELEVANCE TO DOD AND UH NEEDS
.SP 2
8.0}"PERSONNELL
.SP 2
9.0}"CURRICULUM VITAE
.SP 2
10.0 BUDGET^L
.DS